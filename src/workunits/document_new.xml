<workunit>
    <invokers>
        <invoker type="home.action" caption="New Document"  action="start" target="window" />
        
<!--        <invoker type="lobActions" caption="Add" action="lob.add"  immediate="true"/>
        <invoker type="lobActions" caption="Remove" action="lob.remove" immediate="true" 
            visibleWhen="#{lob.selectedItem!=null}"/>
        
        <invoker type="extActions" caption="Print"  icon="images/toolbars/printer.png" 
            action="application.print" visibleWhen="#{state=='save-success'}"/>

        <invoker type="business_application:test" caption="New Application Test"  action="start"  />-->

    </invokers>
    
    <code>
         <![CDATA[    
        import com.rameses.rcp.annotations.*
        import com.rameses.rcp.common.*
        import com.rameses.osiris2.client.*
        import com.rameses.osiris2.common.*
        import java.rmi.server.*;
        import com.rameses.gov.etracs.bpls.controller.*;
        import com.rameses.util.*;
        
        public class NewDocument extends PageFlowController {
            
            @Script("DocumentInfoUtil")
            def document
            
            @Script("DocumentInfoUtil")
            def document
            
            def entity;
    
            void init() {
                //initialize general info
                //initialize verification page
                //initialize attachments
            }
            
           
        }
        ]]>
    </code>    
    
    <pageflow>
        <start>
            <transition to="edit-generalinfo"  action="init"/>
        </start>

        <page name="edit-generalinfo" title="Document Information">
            <transition to="check-title" caption="Next" name="next" mnemonic="N" immediate="false" />
        </page>
        
        <process name="check-title" action="verifyList.name">
            <transition to="verify-documentname" cond="#{verifyList.pass==false}"/>
            <transition to="edit-attachments" cond="#{verifyList.pass==true}"/>
        </process>
        
        <page name="verify-documentname" title="Verify Document Title">
            <transition to="edit-generalinfo" caption="Back" mnemonic="B"/>
            <transition to="edit-attachments" caption="Next" name="next" mnemonic="N" />
        </page>

        <page name="edit-attachments" title="Document Attachments">
            <transition to="edit-generalinfo" caption="Back" mnemonic="B" name="back" />
            <transition to="confirm" caption="Next" name="next" mnemonic="N" />
        </page>

        <page name="confirm" title="Confirm New Document">
            <transition to="edit-attachments" caption="Back" mnemonic="B" name="back"/>
            <transition to="save-success" caption="Submit" mnemonic="S" name="save" confirm="You are about to save this transaction. Continue?"/>
        </page>
        
        <page name="save-success" title="Save Success (New Document)">
            <transition to="edit-generalinfo" caption="Add Another" mnemonic="A" action="init"/>
        </page>

        <end/>
    </pageflow>
    
    <pages>
        <page name="edit-generalinfo" template="tagabukid.dts.view.EditDocumentGeneralInfoPage"/>
        <page name="verify-documentname" template="tagabukid.dts.view.DocumentTitleVerificationPage"/>        
        <page name="edit-attachments" template="tagabukid.dts.view.EditDocumentAttachmentPage"/>
        <page name="confirm" template="tagabukid.dts.view.ConfirmPage"/>
        <page name="save-success" template="tagabukid.dts.view.SuccessPage"/>
    </pages>
    
</workunit>